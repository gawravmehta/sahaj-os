<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flipkart Cookie Consent</title>
    <style>
      /* --- General Styles --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: #f1f3f6;
        min-height: 100vh;
        padding: 0;
      }

      /* --- Cookie Banner Styles --- */
      .cookie-banner {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: #ffffff;
        box-shadow: 0 -2px 16px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        border-top: 1px solid #e0e6eb;
        transform: translateY(100%);
        opacity: 0;
        transition: transform 0.4s ease, opacity 0.4s ease;
      }

      .cookie-banner.show {
        transform: translateY(0);
        opacity: 1;
      }

      .banner-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 20px;
      }

      .banner-header .logo-icon {
        height: 40px;
        cursor: pointer;
      }

      .banner-divider {
        height: 2px;
        background-color: #e0e6eb;
      }

      .cookie-content {
        color: #212121;
        font-size: 13px;
        line-height: 1.5;
        margin: 12px 0;
      }

      .banner-body {
        padding: 10px 20px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .banner-body .button-group {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        flex-wrap: wrap;
        padding: 10px 0;
      }

      .banner-body .btn {
        padding: 4px 8px;
        border-radius: 0px;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.25s ease;
        white-space: nowrap;
      }

      .btn-secondary {
        background-color: white;
        color: #212121;
        border: 1px solid #ccc;
      }

      .btn-secondary:hover {
        background-color: #f5f5f5;
      }

      .btn-primary {
        background-color: white;
        color: #388e3c;
        border: 1px solid #388e3c;
      }

      .btn-primary:hover {
        background-color: #f1f8e9;
      }

      .btn-accept-all {
        background-color: #218838;
        color: white;
        border: 1px solid #218838;
      }

      .btn-accept-all:hover {
        background-color: #1f6e30;
        border-color: #1f6e30;
      }

      /* --- Preference Modal Styles --- */
      .preference-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
      }

      .preference-modal.show {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background-color: #ffffff;
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        border-radius: 4px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .modal-header {
        border-bottom: 1px solid #e0e6eb;
        background-color: white;
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e0e6eb;
        padding: 0px 20px;
        position: relative; /* Needed for absolute positioning of close button */
      }

      .header-bottom {
        padding: 10px 20px;
      }

      .flipkart-logo {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .modal-header .logo-icon {
        height: 50px;
        cursor: pointer;
      }

      .logo-text {
        font-size: 20px;
        font-weight: 500;
        color: #2874f0;
        font-style: italic;
      }

      /* Common Language Selector Styles */
      .language-selector {
        position: relative;
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border: 1px solid #e0e6eb;
        border-radius: 4px;
        background-color: white;
        cursor: pointer;
        font-size: 12px;
        color: #555;
      }

      .language-dropdown {
        display: none;
        position: absolute;
        top: 0px;
        right: 0;
        background: white;
        border: 1px solid #e0e6eb;
        border-radius: 4px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 5px 0;
        z-index: 10;
        min-width: 100px;
        max-height: 100px;
        overflow: auto;
      }

      .language-dropdown.show {
        display: block;
      }

      .language-option {
        padding: 8px 14px;
        font-size: 13px;
        cursor: pointer;
        transition: background 0.2s;
        text-align: left;
      }

      .language-option:hover {
        background-color: #f5f5f5;
      }

      .dropdown-arrow {
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 5px solid #555;
        transition: transform 0.3s;
      }

      .language-selector.open .dropdown-arrow {
        transform: rotate(180deg);
      }

      .preference-title {
        font-size: 20px;
        font-weight: 500;
        color: #212121;
        margin-bottom: 12px;
      }

      .preference-description {
        color: #212121;
        font-size: 13px;
        line-height: 1.5;
        margin-bottom: 8px;
      }

      .cookie-policy-link {
        color: #2874f0;
        text-decoration: none;
        font-weight: 500;
      }

      .cookie-policy-link:hover {
        text-decoration: underline;
      }

      .modal-body {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .consent-section-title {
        font-size: 16px;
        font-weight: 500;
        color: #212121;
        padding: 10px 20px;
        border-bottom: 1px solid #e0e6eb;
      }

      .consent-categories {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      .category-list {
        flex: 0 0 160px;
        border-right: 1px solid #e0e6eb;
        background-color: #f9fcff;
        padding-left: 12px;
        overflow-y: auto;
      }

      .category-item {
        padding: 12px 0;
        font-size: 14px;
        color: #212121;
        cursor: pointer;
        border-left: 3px solid transparent;
        padding-left: 12px;
        margin-left: -12px;
        transition: all 0.2s ease;
      }

      .category-item:hover {
        color: #28a745;
      }

      .category-item.active {
        border-left: 4px solid #28a745;
        color: #212121;
        background-color: white;
        font-weight: 500;
      }

      .category-details {
        flex: 1;
        overflow-y: auto;
        padding: 10px 20px;
      }

      .category-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .category-name {
        font-size: 16px;
        font-weight: 500;
        color: #212121;
      }

      .toggle-switch {
        position: relative;
        width: 44px;
        height: 24px;
        background-color: #e0e6eb;
        border-radius: 12px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      .toggle-switch.active {
        background-color: #28a745;
      }
      .toggle-switch.disabled {
        background-color: #28a745 !important;
        cursor: not-allowed;
      }

      .toggle-switch::after {
        content: "";
        position: absolute;
        top: 2px;
        left: 2px;
        width: 20px;
        height: 20px;
        background-color: white;
        border-radius: 50%;
        transition: transform 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .toggle-switch.active::after {
        transform: translateX(20px);
      }
      .category-description {
        font-size: 13px;
        color: #212121;
        line-height: 1.5;
        margin-bottom: 16px;
      }

      .cookie-details {
        background-color: #f8f9fa;
        border-radius: 4px;
        padding: 12px;
        margin-bottom: 12px;
      }

      .cookie-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
      }

      .cookie-name {
        font-size: 14px;
        font-weight: 500;
        color: #212121;
      }

      .expand-icon {
        width: 0;
        height: 0;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        border-top: 5px solid #878787;
        transition: transform 0.2s ease;
      }

      .expand-icon.expanded {
        transform: rotate(180deg);
      }

      .cookie-info {
        margin-top: 8px;
        padding-top: 8px;
        border-top: 1px solid #e0e6eb;
        display: none;
      }

      .cookie-info.expanded {
        display: block;
      }

      .cookie-meta {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: #878787;
      }

      .modal-footer {
        padding: 10px 20px;
        border-top: 1px solid #e0e6eb;
        background-color: white;
        flex-shrink: 0;
      }

      .footer-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-footer .button-group {
        display: flex;
        gap: 8px;
      }

      .modal-footer .btn {
        padding: 8px 16px;
        border: 1px solid #e0e6eb;
        border-radius: 2px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        white-space: nowrap;
      }

      .btn-reject {
        background-color: white;
        color: #212121;
        border-color: #e0e6eb;
      }

      .btn-reject:hover {
        background-color: #f8f9fa;
      }

      .btn-allow {
        background-color: white;
        color: #388e3c;
        border-color: #388e3c;
      }

      .btn-allow:hover {
        background-color: #f1f8e9;
      }

      .btn-confirm {
        background-color: #28a745;
        color: white;
        border-color: #28a745;
      }

      .btn-confirm:hover {
        background-color: #218838;
      }

      .powered-by {
        font-size: 11px;
        color: #878787;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .concur-logo {
        height: 12px;
        opacity: 0.7;
      }

      /* Close Button for Modal */
      .close-button {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #555;
        padding: 5px;
        line-height: 1;
        transition: color 0.2s ease;
      }

      .close-button:hover {
        color: #212121;
      }

      /* Floating Cookie Settings Button */
      #open-preferences-btn {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background-color: #2874f0;
        color: white;
        padding: 10px 15px;
        border-radius: 4px;
        border: none;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        z-index: 999;
        display: none; /* Hidden by default, shown when consent is given */
        transition: background-color 0.2s ease;
      }

      #open-preferences-btn:hover {
        background-color: #1a5bb5;
      }

      /* --- Responsive Styles --- */
      @media (max-width: 768px) {
        /* Banner */
        .banner-header {
          flex-direction: row;
          gap: 8px;
          align-items: center;
        }

        .cookie-content {
          font-size: 12px;
        }

        .banner-body .button-group {
          flex-direction: column;
          gap: 6px;
          width: 100%;
        }

        .banner-body .btn {
          width: 100%;
          text-align: center;
          padding: 10px 16px;
          font-size: 14px;
        }

        /* Modal */
        .preference-modal {
          padding: 0;
          align-items: stretch;
        }

        .modal-content {
          max-height: 100vh;
          border-radius: 0;
        }

        .header-top {
          margin-bottom: 16px;
        }

        .logo-text {
          font-size: 18px;
        }

        .preference-title {
          font-size: 18px;
        }

        .modal-body {
          flex: 1;
          overflow-y: auto;
          flex-direction: column;
        }

        .consent-categories {
          flex-direction: column;
          height: auto;
          overflow: visible;
        }

        .category-list {
          flex: none;
          border-right: none;
          padding-right: 0;
          margin-bottom: 0;
          display: flex;
          overflow-x: auto;
          gap: 16px;
          -ms-overflow-style: none; /* IE and Edge */
          scrollbar-width: none; /* Firefox */
        }

        .category-list::-webkit-scrollbar {
          display: none; /* Chrome, Safari, Opera */
        }

        .category-item {
          white-space: nowrap;
          padding: 8px 0;
          border-left: none;
          border-bottom: 2px solid transparent;
          padding-left: 0;
          margin-left: 0;
          min-width: fit-content;
        }

        .category-item.active {
          border-left: none;
          border-bottom-color: #218838;
          background-color: transparent;
        }

        .category-details {
          padding-left: 20px;
          border-top: none;
        }

        .modal-footer {
          padding: 16px;
          height: auto;
          flex-shrink: 0;
        }

        .footer-content {
          flex-direction: column;
          gap: 12px;
        }

        .modal-footer .button-group {
          width: 100%;
          flex-direction: column;
        }

        .modal-footer .btn {
          width: 100%;
          text-align: center;
          padding: 12px 16px;
          font-size: 14px;
        }

        .small-scr-btn {
          display: flex;
          align-items: center;
          gap: 6px;
        }

        #open-preferences-btn {
          bottom: 10px;
          left: 10px;
          padding: 8px 12px;
          font-size: 12px;
        }
      }

      /* --- NEW: Layout adjustment for larger screens --- */
      @media (min-width: 769px) {
        .banner-body {
          flex-direction: row;
          justify-content: space-around;
          align-items: center;
          padding: 10px 20px;
          gap: 20px;
        }

        .banner-body .cookie-content {
          flex: 1;
        }
      }

      @media (max-width: 480px) {
        .header-top {
          flex-direction: row;
          gap: 12px;
          align-items: center;
        }

        .category-header {
          flex-direction: flex;
          align-items: flex-start;
          gap: 8px;
        }
      }
    </style>
  </head>
  <body>
    <div class="cookie-banner" id="cookie-banner">
      <div class="banner-header">
        <img
          src="https://www.boardinfinity.com/blog/content/images/2024/09/Flipkart-Logo.png"
          alt="Flipkart Logo"
          class="logo-icon"
        />
        <div class="language-selector" id="language-selector-banner">
          üåê <span id="selected-language-banner">English</span>
          <div class="dropdown-arrow"></div>
          <div class="language-dropdown" id="language-dropdown-banner">
            <div class="language-option" data-lang="en">English</div>
            <div class="language-option" data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</div>
            <div class="language-option" data-lang="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</div>
            <div class="language-option" data-lang="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</div>
          </div>
        </div>
      </div>
      <div class="banner-divider"></div>
      <div class="banner-body">
        <div class="cookie-content" id="cookie-content"></div>
        <div class="button-group">
          <button class="btn btn-secondary" id="cookie-settings-btn"></button>
          <button class="btn btn-primary" id="accept-essential-btn"></button>
          <button class="btn btn-accept-all" id="accept-all-btn"></button>
        </div>
      </div>
    </div>

    <div class="preference-modal" id="preference-modal">
      <div class="modal-content">
        <div class="modal-header">
          <div class="header-top">
            <img
              src="https://www.boardinfinity.com/blog/content/images/2024/09/Flipkart-Logo.png"
              alt="Flipkart Logo"
              class="logo-icon"
            />
            <div class="language-selector" id="language-selector-modal">
              <span>üåê</span>
              <span id="selected-language-modal">English</span>
              <div class="dropdown-arrow"></div>
              <div class="language-dropdown" id="language-dropdown-modal">
                <div class="language-option" data-lang="en">English</div>
                <div class="language-option" data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</div>
                <div class="language-option" data-lang="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</div>
                <div class="language-option" data-lang="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</div>
              </div>
            </div>
            <button class="close-button" id="close-modal-btn">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="feather feather-x"
              >
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>

          <div class="header-bottom">
            <h1 class="preference-title" id="preference-title"></h1>
            <div
              class="preference-description"
              id="preference-description"
            ></div>
          </div>
        </div>

        <h2 class="consent-section-title" id="consent-section-title"></h2>
        <div class="modal-body">
          <div class="consent-categories">
            <div class="category-list">
              <div class="category-item active" data-category="essential"></div>
              <div class="category-item" data-category="performance"></div>
              <div class="category-item" data-category="marketing"></div>
              <div class="category-item" data-category="functional"></div>
              <div class="category-item" data-category="analytics"></div>
            </div>

            <div class="category-details" id="category-details"></div>
          </div>
        </div>

        <div class="modal-footer">
          <div class="footer-content">
            <div class="powered-by">
              <span id="powered-by-text">Powered by</span>
              <svg class="concur-logo" viewBox="0 0 60 12" fill="currentColor">
                <path
                  d="M0 6c0-3.3 2.7-6 6-6s6 2.7 6 6-2.7 6-6 6-6-2.7-6-6zm8-2c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2z"
                />
                <text x="14" y="8" font-size="8" font-weight="600">concur</text>
              </svg>
            </div>
            <div class="button-group">
              <div class="small-scr-btn">
                <button class="btn btn-reject" onclick="rejectAll()"></button>
                <button class="btn btn-allow" onclick="allowAll()"></button>
              </div>
              <button
                class="btn btn-confirm"
                onclick="confirmChoices()"
              ></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <button id="open-preferences-btn">Cookie Settings</button>

    <script>
      // ===== MERGED AND UNIFIED SCRIPT =====

      // --- 1. UNIFIED TRANSLATIONS OBJECT ---
      const translations = {
        en: {
          description:
            "Protean uses cookies to improve service reliability, website quality, and enable personalized features. These cookies may collect personal data for analytics, advertising, and functionality. By consenting to cookies, you agree to data processing as described in our Privacy Policy and Cookie Policy. You can withdraw consent and manage preferences in Cookie Settings.",
          links: [
            {
              text: "Privacy Policy",
              url: "https://proteantech.in/privacy-policy",
            },
            {
              text: "Cookie Policy",
              url: "https://proteantech.in/cookie-policy",
            },
          ],
          bannerButtons: {
            settings: "Cookie Settings",
            essential: "Accept Only Essential",
            acceptAll: "Accept All",
          },
          modalTitle: "Preference Center",
          modalSectionTitle: "Manage Consent Preferences",
          categories: {
            essential: {
              name: "Essential",
              description:
                "These cookies are essential in order to enable you to move around the site and use its features, such as accessing secure areas of the site. Without these cookies, services you have asked for cannot be provided.",
              cookies: [
                {
                  name: "üë§ User Count",
                  description:
                    "Helps track and comply with your cookie consent",
                  domain: "accenture.com",
                  expiry: "1 year",
                },
                {
                  name: "üç™ cc_cookie",
                  description: "Stores cookie consent preferences",
                  domain: "proteantech.in",
                  expiry: "1 year",
                },
              ],
            },
            performance: {
              name: "Performance",
              description:
                "These cookies collect information about how visitors use a website, for instance which pages visitors go to most often, and if they get error messages from web pages.",
              cookies: [
                {
                  name: "üë§ User Count",
                  description:
                    "Helps track and comply with your cookie consent",
                  domain: "accenture.com",
                  expiry: "1 year",
                },
              ],
            },
            marketing: {
              name: "Marketing",
              description:
                "These cookies are used to deliver adverts more relevant to you and your interests. They are also used to limit the number of times you see an advertisement.",
              cookies: [
                {
                  name: "üë§ User Count",
                  description:
                    "Helps track and comply with your cookie consent",
                  domain: "accenture.com",
                  expiry: "1 year",
                },
              ],
            },
            functional: {
              name: "Functional",
              description:
                "These cookies allow the website to remember choices you make and provide enhanced, more personal features.",
              cookies: [
                {
                  name: "üë§ User Count",
                  description:
                    "Helps track and comply with your cookie consent",
                  domain: "accenture.com",
                  expiry: "1 year",
                },
              ],
            },
            analytics: {
              name: "Analytics",
              description:
                "These cookies collect information that is used either in aggregate form to help us understand how our website is being used.",
              cookies: [
                {
                  name: "üë§ User Count",
                  description:
                    "Helps track and comply with your cookie consent",
                  domain: "accenture.com",
                  expiry: "1 year",
                },
              ],
            },
          },
          modalButtons: {
            rejectAll: "Reject All",
            allowAll: "Allow All",
            confirm: "Confirm My Choices",
          },
          poweredBy: "Powered by",
        },
        hi: {
          description:
            "‡§™‡•ç‡§∞‡•ã‡§ü‡•Ä‡§® ‡§∏‡•á‡§µ‡§æ ‡§ï‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø‡§§‡§æ, ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡•Ä ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡•á ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£, ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§î‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§°‡•á‡§ü‡§æ ‡§è‡§ï‡§§‡•ç‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§ï‡•Ä ‡§∏‡§π‡§Æ‡§§‡§ø ‡§¶‡•á‡§ï‡§∞, ‡§Ü‡§™ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ ‡§®‡•Ä‡§§‡§ø ‡§î‡§∞ ‡§ï‡•Å‡§ï‡•Ä ‡§®‡•Ä‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§µ‡§∞‡•ç‡§£‡§ø‡§§ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó ‡§∏‡•á ‡§∏‡§π‡§Æ‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™ ‡§ï‡§≠‡•Ä ‡§≠‡•Ä ‡§∏‡§π‡§Æ‡§§‡§ø ‡§µ‡§æ‡§™‡§∏ ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§ï‡•Å‡§ï‡•Ä ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ‡§è‡§Å ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§",
          links: [
            {
              text: "‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ ‡§®‡•Ä‡§§‡§ø",
              url: "https://proteantech.in/privacy-policy",
            },
            { text: "‡§ï‡•Å‡§ï‡•Ä ‡§®‡•Ä‡§§‡§ø", url: "https://proteantech.in/cookie-policy" },
          ],
          bannerButtons: {
            settings: "‡§ï‡•Å‡§ï‡•Ä ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",
            essential: "‡§ï‡•á‡§µ‡§≤ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç",
            acceptAll: "‡§∏‡§≠‡•Ä ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç",
          },
          modalTitle: "‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞",
          modalSectionTitle: "‡§∏‡§π‡§Æ‡§§‡§ø ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ‡§è‡§Ç ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç",
          categories: {
            essential: {
              name: "‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï",
              description:
                "‡§Ø‡•á ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§æ‡§á‡§ü ‡§ï‡•á ‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ì‡§∞ ‡§ò‡•Ç‡§Æ‡§®‡•á ‡§î‡§∞ ‡§á‡§∏‡§ï‡•Ä ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡§Ç, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§∏‡§æ‡§á‡§ü ‡§ï‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•ã‡§Ç ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡§æ‡•§ ‡§á‡§® ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ, ‡§Ü‡§™‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Æ‡§æ‡§Ç‡§ó‡•Ä ‡§ó‡§à ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä‡§Ç‡•§",
              cookies: [
                {
                  name: "üë§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ó‡§£‡§®‡§æ",
                  description:
                    "‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•Å‡§ï‡•Ä ‡§∏‡§π‡§Æ‡§§‡§ø ‡§ï‡•ã ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§â‡§∏‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à",
                  domain: "accenture.com",
                  expiry: "1 ‡§∏‡§æ‡§≤",
                },
                {
                  name: "üç™ cc_cookie",
                  description: "‡§ï‡•Å‡§ï‡•Ä ‡§∏‡§π‡§Æ‡§§‡§ø ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ‡§è‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à",
                  domain: "proteantech.in",
                  expiry: "1 ‡§∏‡§æ‡§≤",
                },
              ],
            },
            performance: {
              name: "‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§®",
              description:
                "‡§Ø‡•á ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§Ü‡§ó‡§Ç‡§§‡•Å‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§µ‡•á ‡§ï‡§ø‡§® ‡§™‡•É‡§∑‡•ç‡§†‡•ã‡§Ç ‡§™‡§∞ ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§î‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§µ‡•á‡§¨ ‡§™‡•É‡§∑‡•ç‡§†‡•ã‡§Ç ‡§∏‡•á ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç, ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§è‡§ï‡§§‡•ç‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§",
              cookies: [],
            },
            marketing: {
              name: "‡§µ‡§ø‡§™‡§£‡§®",
              description:
                "‡§á‡§® ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Ü‡§™‡§ï‡•á ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•Ä ‡§∞‡•Å‡§ö‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ß‡§ø‡§ï ‡§™‡•ç‡§∞‡§æ‡§∏‡§Ç‡§ó‡§ø‡§ï ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§â‡§®‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§ï‡§ø‡§§‡§®‡•Ä ‡§¨‡§æ‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡•á ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
              cookies: [],
            },
            functional: {
              name: "‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ï",
              description:
                "‡§Ø‡•á ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡•ã ‡§Ü‡§™‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§ï‡•ã ‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡§®‡•á ‡§î‡§∞ ‡§â‡§®‡•ç‡§®‡§§, ‡§Ö‡§ß‡§ø‡§ï ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§è‡§Å ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§",
              cookies: [],
            },
            analytics: {
              name: "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",
              description:
                "‡§Ø‡•á ‡§ï‡•Å‡§ï‡•Ä‡§ú‡§º ‡§ê‡§∏‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§è‡§ï‡§§‡•ç‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•à‡§∏‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§Ø‡§π ‡§∏‡§Æ‡§ù‡§®‡•á ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§≤ ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
              cookies: [],
            },
          },
          modalButtons: {
            rejectAll: "‡§∏‡§≠‡•Ä ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç",
            allowAll: "‡§∏‡§≠‡•Ä ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç",
            confirm: "‡§Æ‡•á‡§∞‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç",
          },
          poweredBy: "‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§",
        },
      };

      // --- 2. DOM ELEMENT SELECTORS ---
      // Banner Elements
      const cookieBanner = document.getElementById("cookie-banner");
      const cookieContent = document.getElementById("cookie-content");
      const cookieSettingsBtn = document.getElementById("cookie-settings-btn");
      const acceptEssentialBtn = document.getElementById(
        "accept-essential-btn"
      );
      const acceptAllBtn = document.getElementById("accept-all-btn");
      const languageSelectorBanner = document.getElementById(
        "language-selector-banner"
      );
      const languageDropdownBanner = document.getElementById(
        "language-dropdown-banner"
      );
      const selectedLanguageBanner = document.getElementById(
        "selected-language-banner"
      );

      // Modal Elements
      const preferenceModal = document.getElementById("preference-modal");
      const languageSelectorModal = document.getElementById(
        "language-selector-modal"
      );
      const languageDropdownModal = document.getElementById(
        "language-dropdown-modal"
      );
      const selectedLanguageModal = document.getElementById(
        "selected-language-modal"
      );
      const preferenceTitle = document.getElementById("preference-title");
      const preferenceDescription = document.getElementById(
        "preference-description"
      );
      const consentSectionTitle = document.getElementById(
        "consent-section-title"
      );
      const categoryList = document.querySelector(".category-list");
      const categoryDetailsContainer =
        document.getElementById("category-details");
      const rejectAllBtn = document.querySelector(".btn-reject");
      const allowAllBtn = document.querySelector(".btn-allow");
      const confirmChoicesBtn = document.querySelector(".btn-confirm");
      const poweredByText = document.getElementById("powered-by-text");
      const closeModalBtn = document.getElementById("close-modal-btn"); // New close button

      // New Cookie Settings Button
      const openPreferencesBtn = document.getElementById(
        "open-preferences-btn"
      );

      // --- 3. HELPER FUNCTIONS ---
      function renderCategoryDetails(lang, category) {
        const data = translations[lang].categories[category];
        if (!data) return;

        let cookieDetailsHtml = "";
        if (data.cookies && data.cookies.length > 0) {
          data.cookies.forEach((cookie) => {
            cookieDetailsHtml += `
            <div class="cookie-details">
              <div class="cookie-header" onclick="toggleCookieInfo(this)">
                <div class="cookie-name">${cookie.name}</div>
                <div class="expand-icon"></div>
              </div>
              <div class="cookie-info">
                <div style="margin-bottom: 8px; font-size: 12px; color: #212121;">${cookie.description}</div>
                <div class="cookie-meta"><span>${cookie.domain}</span><span>${cookie.expiry}</span></div>
              </div>
            </div>`;
          });
        } else {
          cookieDetailsHtml = `<p style="font-size: 13px; color: #878787;">No specific cookies listed for this category.</p>`;
        }

        categoryDetailsContainer.innerHTML = `
          <div class="category-content" data-content="${category}">
            <div class="category-header">
              <div class="category-name">${data.name}</div>
              <div class="toggle-switch ${
                category === "essential" ? "active disabled" : ""
              }" onclick="toggleSwitch(this)"></div>
            </div>
            <div class="category-description">${data.description}</div>
            ${cookieDetailsHtml}
          </div>`;
      }

      function setLanguage(lang) {
        localStorage.setItem("selectedLanguage", lang);
        const langData = translations[lang];

        // Update language display in both selectors
        const langText =
          lang === "en"
            ? "English"
            : lang === "hi"
            ? "‡§π‡§ø‡§®‡•ç‡§¶‡•Ä"
            : lang === "ta"
            ? "‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç"
            : "‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å";
        selectedLanguageBanner.textContent = langText;
        selectedLanguageModal.textContent = langText;
        openPreferencesBtn.textContent = langData.bannerButtons.settings; // Update floating button text

        // Function to replace text with links
        const createLinkedText = (text, links) => {
          let html = text;
          links.forEach((link) => {
            const regex = new RegExp(`(${link.text})`, "g");
            html = html.replace(
              regex,
              `<a href="${link.url}" target="_blank" class="cookie-policy-link">$1</a>`
            );
          });
          return html;
        };

        // Update Banner Content
        cookieContent.innerHTML = createLinkedText(
          langData.description,
          langData.links
        );
        cookieSettingsBtn.textContent = langData.bannerButtons.settings;
        acceptEssentialBtn.textContent = langData.bannerButtons.essential;
        acceptAllBtn.textContent = langData.bannerButtons.acceptAll;

        // Update Modal Content
        preferenceTitle.textContent = langData.modalTitle;
        preferenceDescription.innerHTML = createLinkedText(
          langData.description,
          langData.links
        );
        consentSectionTitle.textContent = langData.modalSectionTitle;
        rejectAllBtn.textContent = langData.modalButtons.rejectAll;
        allowAllBtn.textContent = langData.modalButtons.allowAll;
        confirmChoicesBtn.textContent = langData.modalButtons.confirm;
        poweredByText.textContent = langData.poweredBy;

        // Populate modal category list and details
        document.querySelectorAll(".category-item").forEach((item) => {
          const categoryKey = item.dataset.category;
          item.textContent = langData.categories[categoryKey].name;
        });

        const activeCategory = document.querySelector(".category-item.active")
          .dataset.category;
        renderCategoryDetails(lang, activeCategory);
      }

      function toggleSwitch(element) {
        if (element.classList.contains("disabled")) return;
        element.classList.toggle("active");
      }

      function toggleCookieInfo(element) {
        const cookieInfo = element.nextElementSibling;
        const expandIcon = element.querySelector(".expand-icon");
        cookieInfo.classList.toggle("expanded");
        expandIcon.classList.toggle("expanded");
      }

      function rejectAll() {
        document
          .querySelectorAll(".toggle-switch:not(.disabled)")
          .forEach((toggle) => {
            toggle.classList.remove("active");
          });
      }

      function allowAll() {
        document
          .querySelectorAll(".toggle-switch:not(.disabled)")
          .forEach((toggle) => {
            toggle.classList.add("active");
          });
      }

      function confirmChoices() {
        localStorage.setItem("cookieConsent", "custom");
        preferenceModal.classList.remove("show");
        openPreferencesBtn.style.display = "block"; // Show floating button after confirming choices
      }

      function hideBanner() {
        cookieBanner.classList.remove("show");
        setTimeout(() => {
          cookieBanner.style.display = "none";
          openPreferencesBtn.style.display = "block"; // Show floating button when banner is hidden
        }, 400);
      }

      function showBanner() {
        cookieBanner.style.display = "block";
        setTimeout(() => {
          cookieBanner.classList.add("show");
        }, 10); // Small delay to allow display change to register before transition
        openPreferencesBtn.style.display = "none"; // Hide floating button when banner is shown
      }

      function closePreferenceModal() {
        preferenceModal.classList.remove("show");
        // Only show the floating button if the banner is not visible (i.e., consent was already given)
        if (localStorage.getItem("cookieConsent")) {
          openPreferencesBtn.style.display = "block";
        }
      }

      // --- 4. EVENT LISTENERS ---
      // Language Selection (applied to both dropdowns)
      document.querySelectorAll(".language-option").forEach((option) => {
        option.addEventListener("click", function (e) {
          e.stopPropagation();
          const lang = this.dataset.lang;
          setLanguage(lang);
          languageDropdownBanner.classList.remove("show");
          languageSelectorBanner.classList.remove("open");
          languageDropdownModal.classList.remove("show");
          languageSelectorModal.classList.remove("open");
        });
      });

      languageSelectorBanner.addEventListener("click", () => {
        languageSelectorBanner.classList.toggle("open");
        languageDropdownBanner.classList.toggle("show");
      });

      languageSelectorModal.addEventListener("click", () => {
        languageSelectorModal.classList.toggle("open");
        languageDropdownModal.classList.toggle("show");
      });

      // Close dropdowns if clicked outside
      document.addEventListener("click", function (event) {
        if (!languageSelectorBanner.contains(event.target)) {
          languageDropdownBanner.classList.remove("show");
          languageSelectorBanner.classList.remove("open");
        }
        if (!languageSelectorModal.contains(event.target)) {
          languageDropdownModal.classList.remove("show");
          languageSelectorModal.classList.remove("open");
        }
      });

      // Banner Button Clicks
      acceptAllBtn.addEventListener("click", () => {
        localStorage.setItem("cookieConsent", "all");
        hideBanner();
      });

      acceptEssentialBtn.addEventListener("click", () => {
        localStorage.setItem("cookieConsent", "essential");
        hideBanner();
      });

      cookieSettingsBtn.addEventListener("click", () => {
        hideBanner();
        preferenceModal.classList.add("show");
      });

      // Modal Category Clicks
      document.querySelectorAll(".category-item").forEach((item) => {
        item.addEventListener("click", function () {
          document
            .querySelectorAll(".category-item")
            .forEach((i) => i.classList.remove("active"));
          this.classList.add("active");
          const lang = localStorage.getItem("selectedLanguage") || "en";
          renderCategoryDetails(lang, this.dataset.category);
        });
      });

      // New: Close Modal Button
      closeModalBtn.addEventListener("click", closePreferenceModal);

      // New: Open Preferences Button Click
      openPreferencesBtn.addEventListener("click", () => {
        preferenceModal.classList.add("show");
        openPreferencesBtn.style.display = "none"; // Hide floating button when modal is open
      });

      // --- 5. INITIALIZATION ---
      document.addEventListener("DOMContentLoaded", function () {
        const savedLang = localStorage.getItem("selectedLanguage") || "en";
        setLanguage(savedLang);

        if (!localStorage.getItem("cookieConsent")) {
          showBanner();
        } else {
          hideBanner(); // Ensure banner is hidden if consent already exists
          openPreferencesBtn.style.display = "block"; // Show floating button
        }
      });
    </script>
  </body>
</html>
