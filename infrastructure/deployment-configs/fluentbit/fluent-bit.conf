[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    debug
    Parsers_File parsers.conf
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020
    storage.path /tmp/fluentbit/storage
    storage.sync normal
    storage.checksum off
    storage.max_chunks_up 128
    storage.backlog.mem_limit 5M

# Backend CMP Admin - Main API
[INPUT]
    Name         tail
    Path         /var/log/backend-cmp-admin/*.log
    Tag          backend_cmp_admin_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        backend_cmp_admin_logs
    Host         opensearch-node
    Port         9200
    Index        backend-cmp-admin-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - DP Processing Consumer
[INPUT]
    Name         tail
    Path         /var/log/dp_processing_consumer/*.log
    Tag          dp_processing_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        dp_processing_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        dp-processing-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - DP External Processing Consumer
[INPUT]
    Name         tail
    Path         /var/log/dp_external_processing_consumer/*.log
    Tag          dp_external_processing_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        dp_external_processing_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        dp-external-processing-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Failed Records Consumer
[INPUT]
    Name         tail
    Path         /var/log/failed_records_consumer/*.log
    Tag          failed_records_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        failed_records_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        failed-records-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Notice Notification Consumer
[INPUT]
    Name         tail
    Path         /var/log/notice_notification_consumer/*.log
    Tag          notice_notification_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        notice_notification_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        notice-notification-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Send Email Consumer
[INPUT]
    Name         tail
    Path         /var/log/send_email_consumer/*.log
    Tag          send_email_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        send_email_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        send-email-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Consent Validation Internal Consumer
[INPUT]
    Name         tail
    Path         /var/log/consent_validation_internal_consumer/*.log
    Tag          consent_validation_internal_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_validation_internal_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        consent-validation-internal-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Consent Event Consumer
[INPUT]
    Name         tail
    Path         /var/log/consent_event_consumer/*.log
    Tag          consent_event_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_event_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        consent-event-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Consent Expiry Consumer
[INPUT]
    Name         tail
    Path         /var/log/consent_expiry_consumer/*.log
    Tag          consent_expiry_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_expiry_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        consent-expiry-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Consent Expiry Scheduler
[INPUT]
    Name         tail
    Path         /var/log/consent_expiry_scheduler/*.log
    Tag          consent_expiry_scheduler_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_expiry_scheduler_logs
    Host         opensearch-node
    Port         9200
    Index        consent-expiry-scheduler-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Consent Validation External Consumer
[INPUT]
    Name         tail
    Path         /var/log/consent_validation_external_consumer/*.log
    Tag          consent_validation_external_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_validation_external_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        consent-validation-external-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Cookie Scan Consumer
[INPUT]
    Name         tail
    Path         /var/log/cookie_scan_consumer/*.log
    Tag          cookie_scan_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        cookie_scan_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        cookie-scan-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Data Expiry Consumer
[INPUT]
    Name         tail
    Path         /var/log/data_expiry_consumer/*.log
    Tag          data_expiry_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        data_expiry_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        data-expiry-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Data Expiry Scheduler
[INPUT]
    Name         tail
    Path         /var/log/data_expiry_scheduler/*.log
    Tag          data_expiry_scheduler_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        data_expiry_scheduler_logs
    Host         opensearch-node
    Port         9200
    Index        data-expiry-scheduler-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend CMP Admin - Webhook Consumer
[INPUT]
    Name         tail
    Path         /var/log/webhook_consumer/*.log
    Tag          webhook_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        webhook_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        webhook-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend Customer Portal
[INPUT]
    Name         tail
    Path         /var/log/backend-customer-portal/*.log
    Tag          backend_customer_portal_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        backend_customer_portal_logs
    Host         opensearch-node
    Port         9200
    Index        backend-customer-portal-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend Notice - Main Service
[INPUT]
    Name         tail
    Path         /var/log/backend-notice/*.log
    Tag          backend_notice_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        backend_notice_logs
    Host         opensearch-node
    Port         9200
    Index        backend-notice-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Backend Notice - Consent Processing Consumer
[INPUT]
    Name         tail
    Path         /var/log/consent_processing_consumer/*.log
    Tag          consent_processing_consumer_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        consent_processing_consumer_logs
    Host         opensearch-node
    Port         9200
    Index        consent-processing-consumer-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On

# Cookie Consent Collection
[INPUT]
    Name         tail
    Path         /var/log/cookie-consent-collection/*.log
    Tag          cookie_consent_collection_logs
    Parser       json_app
    Read_from_Head true

[OUTPUT]
    Name         opensearch
    Match        cookie_consent_collection_logs
    Host         opensearch-node
    Port         9200
    Index        cookie-consent-collection-logs
    HTTP_User    ${OPENSEARCH_USER}
    HTTP_Passwd  ${OPENSEARCH_PASSWORD}
    tls          On
    tls.verify   Off
    Suppress_Type_Name On
